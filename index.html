<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>copypasta</title>
</head>
<body>
    <pre>
# create input directory in HDFS and put file
hdfs dfs -mkdir -p /user/$(whoami)/input
hdfs dfs -put -f ~/votes.txt /user/$(whoami)/input/

# find hadoop-streaming jar (print to confirm)
STREAMING_JAR=$(ls /usr/lib/hadoop-mapreduce/hadoop-streaming*.jar 2>/dev/null | head -n1)
echo "Using $STREAMING_JAR"

# Run the streaming job (output directory must not exist already)
hdfs dfs -rm -r -skipTrash /user/$(whoami)/output_votes 2>/dev/null || true
hadoop jar $STREAMING_JAR \
  -files /home/$(whoami)/mapper.py,/home/$(whoami)/reducer.py \
  -mapper mapper.py -reducer reducer.py \
  -input /user/$(whoami)/input/votes.txt \
  -output /user/$(whoami)/output_votes

    </pre>
</body>
</html>